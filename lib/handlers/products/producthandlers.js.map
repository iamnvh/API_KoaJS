{"version":3,"file":"producthandlers.js","names":["getProducts","ctx","delay","ms","Promise","res","setTimeout","limit","sort","name","query","products","listQuery","body","data","error","status","success","message","save","product","request","addProduct","update","id","parseInt","params","updateProduct","remove","Math","floor","removeProduct","getProductById","findProduct"],"sources":["../../../src/handlers/products/producthandlers.js"],"sourcesContent":["import { list as listQuery,add as addProduct, remove as removeProduct, update as updateProduct, find as findProduct } from '../../database/productRepository'\r\n\r\nexport async function getProducts(ctx) {\r\n    try {\r\n        const delay = ms => new Promise(res => setTimeout(res, ms));\r\n        await delay(2000);\r\n        const {limit, sort, name} = ctx.query;\r\n        const products = listQuery({limit, sort, name})\r\n        return ctx.body = {\r\n            data: products\r\n        };\r\n    } catch (error) {\r\n        ctx.status = 404;\r\n        return ctx.body = {\r\n            success: false,\r\n            data: [],\r\n            error: error.message\r\n        }\r\n    }\r\n}\r\n\r\nexport async function save(ctx) {\r\n    try {\r\n        const product = ctx.request.body;\r\n        const data = addProduct(product)\r\n        ctx.status = 201;\r\n        return ctx.body = {\r\n            data: data,\r\n            success: true,\r\n        }\r\n    } catch (error) {\r\n        return ctx.body = {\r\n            success: false,\r\n            error: error.message\r\n        }\r\n    }\r\n}\r\nexport function update(ctx) {\r\n    try {\r\n        const id = parseInt(ctx.params.id);\r\n        const product = ctx.request.body;\r\n        const data = updateProduct(product,id)\r\n        if (data === false) {\r\n            return ctx.body = {\r\n                success: false, \r\n                message: \"ID not found\"\r\n            }\r\n        }\r\n        ctx.status = 201;\r\n        return ctx.body = {\r\n            success: true,\r\n        }\r\n    } catch (error) {\r\n        return ctx.body = {\r\n            success: false,\r\n            error: error.message\r\n        }\r\n    }\r\n}\r\n\r\nexport function remove(ctx) {\r\n    try {\r\n        const id = Math.floor(ctx.params.id);\r\n        const data = removeProduct(id)\r\n        if (data === false) {\r\n            ctx.status = 404;\r\n            return ctx.body = {\r\n                status: 'error',\r\n                message: 'Product not found',\r\n            }\r\n        }\r\n        ctx.status = 201;\r\n        return ctx.body = {\r\n            success: true,\r\n        }\r\n    } catch (error) {\r\n        return ctx.body = {\r\n            success: false,\r\n            error: error.message\r\n        }\r\n    }\r\n}\r\nexport function getProductById(ctx) {\r\n    try {\r\n        const id = parseInt(ctx.params.id);\r\n        const data = findProduct(id)\r\n        if (typeof data === 'undefined') {\r\n            ctx.status = 404;\r\n            return ctx.body = {\r\n                status: 'error',\r\n                message: 'Product not found',\r\n            }\r\n        }\r\n        ctx.status = 201;\r\n        return ctx.body = {\r\n            success: true,\r\n            data: data\r\n        }\r\n    } catch (error) {\r\n        return ctx.body = {\r\n            success: false,\r\n            error: error.message\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"}